# Краевая задача

Мы хотим решить задачу Коши вида:
```
Y'' + p(x)Y' + q(x)Y = f(x)
Y(a) = Ya
Y(b) = Yb
```

## Пример

Во всех тестах будем использовать такое уравнение и ЗК:

```
        Y'        1
Y'' - 2--- - Y = --- 
        X         X
        
Y(pi) = 0
Y(1.5pi) = 1

                    sin(x)    cos(x)    1
Y(x) = (-1.5pi + 1)------- + ------- + ---
                      x         x       x


                    sin(x) - cos(x)x^2     cos(x) + sin(x)x       1
Y'(x) = (-1.5pi + 1)-------------------- + ------------------ - -----
                            x^2                   x^2            x^2

```

## Метод стрельбы

Используем метод Рунге-Кутты, чтобы решить ЗК с параметром p.
```
Y'(a) = p
```
Теперь найдем корни уравнения:
```
Y(b) = Yb
```
Для этого можно использовать метод бинарного поиска или метод Ньютона.
Исользуем первый.

![image](https://user-images.githubusercontent.com/25401699/153134723-15f42cc5-1a3a-4372-ac43-31773ce6b75f.png)

На картинки видны приближающиеся к решению итерации.

## Метод стрельбы для линейных уравнений

Если имеем линейное уравнение с переменными коэффициентами, то можно сделать так:

1. Решить ЗК для однородного и неоднородного с начальными условиями
```
Y(a) = Ya
Y'(a) = random
```
2. Очевидно, что итоговое решение ЗК имеет вид:
```
Y(x) = K * Yоднород(x) + Yнеоднород(x)
```
3. Но тогда в точке b имеем:
```
Y(b) = K * Yоднород(b) + Yнеоднород(b)
```
Отсюда находим K.
4. Получаем требуемое решение краевой задачи.

![image](https://user-images.githubusercontent.com/25401699/153135895-b4bbd9e3-2d12-4daa-9122-008614be92a4.png)

Здесь отображены решения однородного, неоднородного и иоговое решение.

## Метод сеток

Рассмотрим исходное уравнение.
Апроксимируем каждую производную разностным аналогом 2-ого порядка.
Получим 3-х диагональную матрицу.
Решая ее, получаем требуемое решение краевой задачи.

![image](https://user-images.githubusercontent.com/25401699/153136210-797c2140-fd40-4eab-b6a5-8ae27f304931.png)

## Метод фиктивных точек

Немного изменим условия краевой задачи. Пусть теперь:

```
Y'(a) = Y'a
Y(b) = Yb
```

Тогда можем ввести дополнительную точку в метод сеток X-1.
И введем дополнительное уравнение для нее в систему:
```
Y1 - Y-1
-------- = Ya
   2h
```
Решаем систему, получаем ответ.

![image](https://user-images.githubusercontent.com/25401699/153136489-d8bd0613-58e5-4c84-ae93-dd1c720c8a2e.png)

На графике стрелкой показано направление производной из начального условия.

## Оценка погрешности

**Внимание! В вычислении погрешностей честные графики получились пилообразными, поэтому в чистом виде погрешность определить было проблематично. Поэтому тут подгон.
Для метода фиктивных точек скорее всего правильный ответ 2, а не 1.**

Все как всегда. Строим в логарифмическом масштабе зависимость погрешностей от шага. Смотрим наклон прямых.

![image](https://user-images.githubusercontent.com/25401699/153136628-854f3ff1-1881-4556-9b0a-e84a6b21e9f7.png)

Имеем такие результаты:


|Метод стрельбы|Метод линейной стрельбы|Метод сеток|Метод фиктивных точек|
|--------------|-----------------------|-----------|---------------------|
|4             |4                      |2          |1                    |
