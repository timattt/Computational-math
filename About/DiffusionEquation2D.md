# Двумерное стацинарное уравнение диффузии

## Постановка задачи

<img src="https://user-images.githubusercontent.com/25401699/166260772-6a5d5fc3-cd3d-41f5-bdff-4bf47d8f13f9.png" alt="drawing" width="500"/>
<img src="https://user-images.githubusercontent.com/25401699/166260910-ed36533c-ed8d-44d5-bffb-283249412e26.png" alt="drawing" width="200"/>

## Метод решения

1. У нас есть граница. Мы эту границу дискретизируем конечных набором точек.
2. У нас есть внутренность. Мы туда рандомно накидываем точки. По возможности равномерно, но в целом это пофигу.
3. Теперь используем диаграмму Воронова. Получаем клетки Дирихле.

<img src="https://user-images.githubusercontent.com/25401699/166262779-4bd369b0-3b86-4a47-bb9d-725aa5eef4be.png" alt="drawing" width="600"/>

На картинке точка **i**. Она в своей клетке Дирихле. Также там есть один ее сосед **j**. Есть граничное ребро **Гj**. Есть нормаль **nj** и расстояние между соседями **dj**. Также известен объем клетки **Vi**. Все эти вещи можно вычислить на основе диаграммы Воронова.

4. Теперь произведем объемную апроксимацию.

<img src="https://user-images.githubusercontent.com/25401699/166263792-ac267d9b-420f-45fd-b5b1-c5a7a9388a90.png" alt="drawing" width="1000"/>

В конце можно **Uj** заменить на полусумму **Ui** и **Uj** для большей точности.

<img src="https://user-images.githubusercontent.com/25401699/166263910-d8ab7c92-854f-41ee-bbfa-0e6a3043b9a4.png" alt="drawing" width="1000"/>

5. Сгрупируем по неизвестным.

![image](https://user-images.githubusercontent.com/25401699/166264114-90840253-73cf-4391-8360-c0973b732257.png)

6. Пусть у нас было N точек граничных условий. И M точек внутренности. Тогда мы можем записать M уравнений выше для M точек внутренности. И N уравнений начальных условий вида **Ui = U0(i)**. Тогда получаем систему уравнений. Которую можно решить. Решаем ее.

## Тестовое решение

Обратимся к урматам. Возьмем такой пример и немного модифицируем.

![image](https://user-images.githubusercontent.com/25401699/166292503-957d2644-f062-4fff-9176-cc7b0d70b4ab.png)

Таким образом, чтобы правая часть была больше нуля. Чтобы K было равно -1. И чтобы решение было больше нуля. Получим вот такую ЗК.

![image](https://user-images.githubusercontent.com/25401699/166292676-58503beb-d7b5-4223-88ee-043359403787.png)

Проверим, что решение действительно больше нуля.

![image](https://user-images.githubusercontent.com/25401699/166292755-c2763d81-b0ef-45ba-838b-6fc8949fa959.png)

