# Двумерное стацинарное уравнение диффузии

## Постановка задачи

<img src="https://user-images.githubusercontent.com/25401699/166260772-6a5d5fc3-cd3d-41f5-bdff-4bf47d8f13f9.png" alt="drawing" width="500"/>
<img src="https://user-images.githubusercontent.com/25401699/166260910-ed36533c-ed8d-44d5-bffb-283249412e26.png" alt="drawing" width="200"/>

## Метод решения

1. У нас есть граница. Мы эту границу дискретизируем конечных набором точек.
2. У нас есть внутренность. Мы туда рандомно накидываем точки. По возможности равномерно, но в целом это пофигу.
3. Теперь используем диаграмму Воронова. Получаем клетки Дирихле.

<img src="https://user-images.githubusercontent.com/25401699/166262779-4bd369b0-3b86-4a47-bb9d-725aa5eef4be.png" alt="drawing" width="600"/>

На картинке точка **i**. Она в своей клетке Дирихле. Также там есть один ее сосед **j**. Есть граничное ребро **Гj**. Есть нормаль **nj** и расстояние между соседями **dj**. Также известен объем клетки **Vi**. Все эти вещи можно вычислить на основе диаграммы Воронова.

4. Теперь произведем объемную апроксимацию.

<img src="https://user-images.githubusercontent.com/25401699/166263792-ac267d9b-420f-45fd-b5b1-c5a7a9388a90.png" alt="drawing" width="1000"/>

В конце можно **Uj** заменить на полусумму **Ui** и **Uj** для большей точности.

<img src="https://user-images.githubusercontent.com/25401699/166263910-d8ab7c92-854f-41ee-bbfa-0e6a3043b9a4.png" alt="drawing" width="1000"/>

5. Сгрупируем по неизвестным.

![image](https://user-images.githubusercontent.com/25401699/166264114-90840253-73cf-4391-8360-c0973b732257.png)

6. Пусть у нас было N точек граничных условий. И M точек внутренности. Тогда мы можем записать M уравнений выше для M точек внутренности. И N уравнений начальных условий вида **Ui = U0(i)**. Тогда получаем систему уравнений. Которую можно решить. Решаем ее.

## Тестовое решение

Обратимся к урматам. Возьмем такой пример и немного модифицируем.

![image](https://user-images.githubusercontent.com/25401699/166292503-957d2644-f062-4fff-9176-cc7b0d70b4ab.png)

Таким образом, чтобы правая часть была больше нуля. Чтобы K было равно -1. И чтобы решение было больше нуля. Получим вот такую ЗК.

![image](https://user-images.githubusercontent.com/25401699/166299311-5d6057d1-8a37-4173-8986-daf98f0074e5.png)

Проверим, что решение действительно больше нуля.

![image](https://user-images.githubusercontent.com/25401699/166299236-6c11a7df-4b43-479b-8137-d10c48344253.png)

## Тестирование

### Простой случай диаграммы

Возьмем круговую область и будем равномерно накидывать туда точки.

![image](https://user-images.githubusercontent.com/25401699/166300801-a1a69e9e-4d43-4d28-92a5-0cf9e9c5b3bb.png)

Теперь построим диаграмму.

![image](https://user-images.githubusercontent.com/25401699/166300862-d3a7e724-33ba-484a-bc10-8ae69ed7aa12.png)

И получаем решение.

![image](https://user-images.githubusercontent.com/25401699/166300902-c1986a23-f3ae-43a8-badd-96a23bcb45d5.png)

### Сложный случай диаграммы

Возьмем круговую область, но теперь будем в нее накидывать рандомно.

![image](https://user-images.githubusercontent.com/25401699/166301034-a957142a-68d2-482f-ae4c-89753b8966de.png)

И снова построим диаграмму Воронова.

![image](https://user-images.githubusercontent.com/25401699/166301105-3782ef0c-4525-4f7f-941c-5ba88a85fdfd.png)

И решение получается.

![image](https://user-images.githubusercontent.com/25401699/166301188-27d46b55-ff0f-4010-870a-214706aff09f.png)

## Оценка погрешности

Как обычно построим зависимость ошибки от шага и прологарифмируем.

![image](https://user-images.githubusercontent.com/25401699/166301445-403a0f3a-80fa-469e-94b9-f2d785ca8c03.png)


Итого погрешность этого метода: **первый порядок**. 

