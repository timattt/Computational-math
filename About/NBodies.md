# Астрофизика и задача N тел

## Интегрирование уравнения движения методом Рунге-Кутты

Пусть нам заданы **N** тел. У каждого известны:
1. масса
2. начальное положение
3. начальная скорость   

Запишем **II закон Ньютона** для каждого тела.
Мы умеем решить задачу Коши для ОДУ. Т.е. уравнения вида:
```
dX
-- = f(X, t)
dt
```
Где **X** является вектором.
Поэтому, переходя в **4N-мерное пространство**, получаем вот такую систему ОДУ:

<img src="https://user-images.githubusercontent.com/25401699/149898481-8e4bcf39-f6c3-47f9-b296-57efd80fd9b8.png" alt="drawing" width="500"/>

Теперь нам необходимо получить достаточно точное решение.
Воспользуемся методом **Рунге-Кутты**.

Имеем рекуррентную формулу на каждую следующую точку 4N-мерного пространства в сетке. 

<img src="https://user-images.githubusercontent.com/25401699/149899827-39144f5c-50ec-449c-b60c-acfb2a1c4a24.png" alt="drawing" width="500"/>

Отметим так же, что данный метод имеет 4-ый порядок точности, что позволяет немного сэкономить на вычислительной мощности.
Однако, погрешность зависит от максимума второй производной интегрируемой функции ОДУ. Так как функция обратна пропорциональна расстоянию до тела, то при сближении двух тел точность будет очень сильно снижаться. Что выражается в резких отталкиваниях объектов друг от друга на бесконечность. При этом будут нарушены любые аналитические закономерности, в частности, тело может покинуть потенциальную яму, что в идеальных условиях было бы невозможно.

## Задача 2-ух тел

Как известно, в задаче двух тел центр масс двигается поступательно, а тела относительно центра масс двигаются по эллиптической орбите.

### Пример 1

Два тела с одинаковыми массами

![2bp1](https://user-images.githubusercontent.com/25401699/149902317-dc2415e8-07d3-4e0a-903f-c668c6ccd9e7.gif)

### Пример 2

Одно из тел в десять раз тяжелее другого

![2bp2](https://user-images.githubusercontent.com/25401699/149902841-9bcda0df-e36d-4213-8096-a833945e1b20.gif)

В данном случае скорость легкого тела соотвествовала первой космической, относительно второго тела. Поэтому оно двигается по орбите.
В следующем примере будет иначе.

### Пример 3

![2b3](https://user-images.githubusercontent.com/25401699/149904528-9e67be42-aa9f-4f6d-bf20-951ba23cd428.gif)

Здесь наблюдается параболическое движение. Т.к. начальная скорость первого тела больше второй космической.

## Гравитационный маневр

В предыдущем примере можно заметить, что скорость легкого тела после пролета мимо тяжелого тела изменилась.
При этом никаких других сил в расчете не было. Т.е. использую сторонние космические тела мы можем изменять скорость выбранного тела, если направить его на параболлическую орбиту
вокруг тяжелого тела. В этом и заключается смысл гравитационного маневра.

Рассмторим несколько примеров, причем в этот раз будет отслеживать изменение кинетической энергии исследуемого тела.

### Пример 4

Пример гравитационного замедления.

![gm1](https://user-images.githubusercontent.com/25401699/149906301-723b4b6f-0ae7-4d9c-8316-6bd412505d93.gif)

### Пример 5

Пример гравитационного ускорения.

![gm2](https://user-images.githubusercontent.com/25401699/149907864-e1099d6a-42fd-4d5b-abbe-bed4fc2a585e.gif)

## Эффект Оберта

[сюда](https://ru.wikipedia.org/wiki/%D0%AD%D1%84%D1%84%D0%B5%D0%BA%D1%82_%D0%9E%D0%B1%D0%B5%D1%80%D1%82%D0%B0)

## Задача 3-х тел

Нарисовать кучу картинок

## Особые случаи задачи 3-х тел

[сюда](https://en.wikipedia.org/wiki/Three-body_problem)

## Приближенная модель солнечной системы

Просто порисовать прикольные графики

## Столкновение галактик

Опционально. Если будет нехватать материала.
Вставить видео из статьи на хабре
