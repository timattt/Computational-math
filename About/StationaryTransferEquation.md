# Решение одномерного стационарного уравнения переноса

Эта лаба отличается от предыдущей только тем, что здесь мы внимательно изучаем монотонность нашей разностной схемы.
Но вообще, эта лаба является прологом к решению нестационарных и многомерных уравнений переноса в частных производных.

## Тестовый пример

```
y'' + V(x)y' = f(x)

V(x) = x
f(x) = -pi^2 * sin(pi * x) + pi * x * cos(pi * x)

y(0) = 0
y(1) = 0

y = sin(pi * x)
```

## Конечная объемная апроксимация со вторым порядком

Имеем рекурентную формулу.

```
Ai * Yi+1 + Bi * Yi + Ci * Yi-1 = Di

Ai = k / h^2 + Vi-0.5 / (2*h)
Bi = Vi+0.5 / (2*h) - 2*k / h^2
Ci = k / h^2 - Vi+0.5 / (2*h)

Y0 = 0
YN = 0
```

Находим корни трехдиагональной матрицы такой системы.
Оцениваем числа Пекле в каждом узле:

```
       Vi * h
PEi = --------
         Ki
```

Имеем что-то такое:

![image](https://user-images.githubusercontent.com/25401699/157630019-ae5aa1ce-7b3b-4b2b-a8a8-718588497a05.png)

## Монотонизированная схема

У нас критерий монотонности выглядит так:

```
PE < 2
```

Давайте заменил K так, чтобы это всегда выполнялось.
Пусть:

```
K = K * (1 + r)
```

Тогда

```
 V*h
----- - 1 = r
 2K
```

Заменим K на новое. И получим:

![image](https://user-images.githubusercontent.com/25401699/157630094-29bfde74-153e-495b-96f4-5c2d50450e89.png)


Теперь критерий монотонности выполняется всегда. И график выглядит получше.

## Безусловно монотонная схема

В операторном виде задача записывалась так:

```
D[y] + C[y] = f
```

где

```
           d^2
D[y] = k ------y
          dx^2

            dy
C[y] = V(x)----
            dx
```

Соответственно этим операторам ставятся сеточные аналоги.
(чисто производные апроксимируем и получаем)
Но такой подход не дает гарантии монотонности.
Поэтому определим сеточный оператор C вот так:

```
C*[Y]i = 1/h * [VPi+0.5 * Yi + VMi+0.5 * Yi+1 - VPi-0.5 * Yi-1 - VMi-0.5 * Yi]

VPi = 0.5 * (Vi + |Vi|)
VMi = 0.5 * (Vi - |Vi|)
```

В итоге рекуррентное уравнение будет такое:

```
Yi+1 [-k/h^2 + VMi+0.5/h] + Yi * [2k/h^2 + VPi+0.5 / h - VMi-0.5 / h] + Yi-1 * [-k/h^2 - VPi-0.5 / h] = fi
```

Получаем что-то такое:

![image](https://user-images.githubusercontent.com/25401699/157630132-6b97fa4e-5a77-417a-9224-26379fa2900f.png)

## Оцениваем погрешности

Как обычно, получим зависимость погршности от шага. Прологарифмируем и возьмем коэффицент прямой.

![image](https://user-images.githubusercontent.com/25401699/157630263-5eef2f8e-2d4d-4ff3-aafa-1d013dd33145.png)

| Конечная объемная аппроксимация | Монотонизированная схема | Безусловно монотонная схема |
|---------------------------------|--------------------------|-----------------------------|
| 2                               | 2                        | 1                           |
