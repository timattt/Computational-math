# Интересные задачи вычислительной физики

## Интерполяции

Пусть у нас есть N точек на плоскости. Тогда существует и единственнен полином порядка N, который проходит через все эти точки.

### Метод лагранжа

У нас есть удобная формула для построения таких полиномов.

![image](https://user-images.githubusercontent.com/25401699/142418585-b8c0c74f-1e59-448f-96c0-5981f8ef7635.png)

### Пример

![image](https://user-images.githubusercontent.com/25401699/142419809-e843eed9-ff60-4990-9774-6138e4d86aa5.png)

## Численное дифференцирование

Задача такая - есть непрерывная функция, нужно взять ее первую и вторую производные.

### Простейший случай

Самый простой вариант - это первая производная с первым порядком точности, где погрешность пропорциональна порядку разбиения.

```
f'n = [f(Xn+1) - f(Xn)] / h;
Xn - сетка аргумента.
f - наша непрерывная функция.
h - размер разбиения.
f'n - сетка производной функции.
```

### Большая точность

Но если мы хотим большую точность, то нам нужно взять несколько узлов сетки, построить интерполяционный полином и взять производную.
Таким образом можно находить любые производные с любым порядком точности.

### Пример

![](https://github.com/timattt/Project-computational-math/blob/master/Images/DiffExample.png)

## Решение задачи Коши для обыкновенного дифференциального уравнения

Имеем такое уравнение:
```
dy
-- = f(x, y)
dx
```
Имеем начальное условие:
```
f(x0) = y0
```
Переменная **y**, вообще говоря может быть вектором.
Наша задача - решить уравнение, т.е. получить два массива - значения **x** и **y** - т.е. их зависимость.

### Явный метод Эйлера

Самый простой путь решения просто представить dx малым числом и приблизить дифференциал.
То есть, если первую точки итоговой кривой (x0, y0) мы уже знаем, то следующая точка сетки вычисляется вот так:

$$
y_1 = f(x_0, y_0) * h + y_0
$$

![image](https://user-images.githubusercontent.com/25401699/145378708-d6481b69-1282-44a9-a1cf-78529644c305.png)

### Метод Рунге-Кутты

Самый популярный метод численного решения ЗК 4ого порядка.

![image](https://user-images.githubusercontent.com/25401699/145380431-19e3c881-2c3d-403d-a81f-9a481f75b7dc.png)

### Примеры решения дифуров

![image](https://user-images.githubusercontent.com/25401699/145378783-9ccec97a-8f02-4dd5-ab07-d716086c9fca.png)

![image](https://user-images.githubusercontent.com/25401699/145380146-51a8abad-4f0a-4916-aff9-8a5ae8dca733.png)

![image](https://user-images.githubusercontent.com/25401699/145380355-1af24fb0-2d98-4c98-9180-65d9b7c8c43c.png)

![image](https://user-images.githubusercontent.com/25401699/145380453-d61fdc5d-7de8-43e3-8875-4cc53f62a42a.png)

## Задача N тел

## Интегрирование уравнения движения методом Рунге-Кутты

Пусть нам заданы **N** тел. У каждого известны:
1. масса
2. начальное положение
3. начальная скорость   

Запишем **II закон Ньютона** для каждого тела.
Мы умеем решить задачу Коши для ОДУ. Т.е. уравнения вида:
```
dX
-- = f(X, t)
dt
```
Где **X** является вектором.
Поэтому, переходя в **4N-мерное пространство**, получаем вот такую систему ОДУ:

<img src="https://user-images.githubusercontent.com/25401699/149898481-8e4bcf39-f6c3-47f9-b296-57efd80fd9b8.png" alt="drawing" width="500"/>

Теперь нам необходимо получить достаточно точное решение.
Воспользуемся методом **Рунге-Кутты**.

Имеем рекуррентную формулу на каждую следующую точку 4N-мерного пространства в сетке. 

<img src="https://user-images.githubusercontent.com/25401699/149899827-39144f5c-50ec-449c-b60c-acfb2a1c4a24.png" alt="drawing" width="500"/>

Отметим так же, что данный метод имеет 4-ый порядок точности, что позволяет немного сэкономить на вычислительной мощности.
Однако, погрешность зависит от максимума второй производной интегрируемой функции ОДУ. Так как функция обратна пропорциональна расстоянию до тела, то при сближении двух тел точность будет очень сильно снижаться. Что выражается в резких отталкиваниях объектов друг от друга на бесконечность. При этом будут нарушены любые аналитические закономерности, в частности, тело может покинуть потенциальную яму, что в идеальных условиях было бы невозможно.

## Задача 2-ух тел

Как известно, в задаче двух тел центр масс двигается поступательно, а тела относительно центра масс двигаются по эллиптической орбите.

### Пример 1

Два тела с одинаковыми массами

![2bp1](https://user-images.githubusercontent.com/25401699/149902317-dc2415e8-07d3-4e0a-903f-c668c6ccd9e7.gif)

### Пример 2

Одно из тел в десять раз тяжелее другого

![2bp2](https://user-images.githubusercontent.com/25401699/149902841-9bcda0df-e36d-4213-8096-a833945e1b20.gif)

В данном случае скорость легкого тела соответствовала первой космической, относительно второго тела. Поэтому оно двигается по орбите.
В следующем примере будет иначе.

### Пример 3

![2b3](https://user-images.githubusercontent.com/25401699/149904528-9e67be42-aa9f-4f6d-bf20-951ba23cd428.gif)

Здесь наблюдается параболическое движение. Т.к. начальная скорость первого тела больше второй космической.

## Гравитационный маневр

В предыдущем примере можно заметить, что скорость легкого тела после пролета мимо тяжелого тела изменилась.
При этом никаких других сил в расчете не было. Т.е. использую сторонние космические тела мы можем изменять скорость выбранного тела, если направить его на параболическую орбиту
вокруг тяжелого тела. В этом и заключается смысл гравитационного маневра.

Рассмотрим несколько примеров, причем в этот раз будет отслеживать изменение кинетической энергии исследуемого тела.

### Пример 4

Пример гравитационного замедления.

![gm1](https://user-images.githubusercontent.com/25401699/149906301-723b4b6f-0ae7-4d9c-8316-6bd412505d93.gif)

### Пример 5

Пример гравитационного ускорения.

![gm2](https://user-images.githubusercontent.com/25401699/149907864-e1099d6a-42fd-4d5b-abbe-bed4fc2a585e.gif)

## Эффект Оберта

Можно заметить, что ракетный двигатель, движущийся с высокой скоростью, совершает больше полезной работы, чем такой же двигатель, движущийся медленно.
т.к. работа силы - это:
```
A = F * dr = F * dr/dt * dt = F * V * dt
```
Следовательно, эффективность силы будет больше, если скорость будет больше
В этом заключается эффект Оберта.
Будем скачкообразно добавлять скорость и посмотрим, что получится.

### Пример 6

![oe1](https://user-images.githubusercontent.com/25401699/149913368-ec238545-09e5-42c5-86b1-5714f18e11eb.gif)

Видно, что наиболее выгодно включать двигатель в перицентре параболической орбиты.

## Задача 3-х тел

Возьмем три тела и сразу рассмотрим несколько примеров.

### Пример 7

Два тела изначально двигались по эллиптической орбите, но прилет третьего все сломал, в результате все три двигаются в бесконечность отдельно.

![3bp1](https://user-images.githubusercontent.com/25401699/149921451-5b09f79f-c607-43c2-bf5a-e4c7cd9c9377.gif)

### Пример 8

Два тела изначально двигались по эллиптической орбите, но прилет третьего заставил одно тело улететь на бесконечность, а два других образовали новую эллиптическую орбиту.   
Этакий "любовный" треугольник.

![3bp2](https://user-images.githubusercontent.com/25401699/149921632-5fa22880-0ec8-4138-821c-d37ed958eadf.gif)

### Пример 9

Здесь в центре располагается массивное тело. Вокруг него по эллиптическим орбитам летают два других легких тела.

![3bp3](https://user-images.githubusercontent.com/25401699/149922026-ed091924-3902-4d55-8788-c5be45757207.gif)

### Пример 10

Взаимодействие двух легких тел с одним тяжелым.

![3bp4](https://user-images.githubusercontent.com/25401699/149922144-96b132a9-dc0e-4383-8b05-5854dcb7176f.gif)

### Пример 11

Этот моделирует поведение **двойной звезды**.

![3bp5](https://user-images.githubusercontent.com/25401699/149922278-c59ce400-969c-456a-8ece-2f2087ca04e5.gif)

## Приближенная модель солнечной системы

Теперь посмотрим, что будет если тел будет порядка 10.
Попробуем создать солнечную систему с 9 планетами и 1 тяжелой звездой в центре.

### Пример 12

Это абсолютно симметричное движение в псевдо-солнечной системе.

![ss1](https://user-images.githubusercontent.com/25401699/149923125-21065812-5478-4a6d-acd7-38eeb4fcb32a.gif)

### Пример 13

Рассмотрим хаос в псевдо-солнечной системе.

![ss2](https://user-images.githubusercontent.com/25401699/149923977-aade2da2-2484-4462-b155-ebb6e2e734fc.gif)

### Пример 14

Еще один пример хаоса. В итоге псевдо-солнечная система полностью рассыпалась.

![ss3](https://user-images.githubusercontent.com/25401699/149925215-b069b945-26e2-4322-8049-66cb26778602.gif)

## Интегрирование

### Левые или правые прямоугольники

Делим отрезок на n равноудаленных точек. Суммируем прямоугольники, берем левую или правую точку.

```
I = sum f(xi) * (xi+1 - xi)
     i
```

![image](https://user-images.githubusercontent.com/25401699/144395312-9849b2eb-e4be-4bce-80ae-5d1e4c9d44e5.png)

### Центральные прямоугольники

Аналогично предыдущему пункту, но теперь берем центральные точку подотрезков.

```
I = sum f(xi+0.5) * (xi+1 - xi)
     i
```

![image](https://user-images.githubusercontent.com/25401699/144395581-046636b4-9d7f-4850-9bc1-c4f48d0c7042.png)

### Трапеции

Тепепь суммируем трапеции с вершинами в крайних точках.

```
I = sum 0.5 * (f(xi) + f(xi+1)) * (xi+1 - xi)
     i
```

![image](https://user-images.githubusercontent.com/25401699/144395755-0ffe1c97-a600-4623-ad56-ea329202108a.png)

### Правило Симпсона

Теперь будем апроксимировать подкривые параболами.

```
I = sum 1/6 * (f(xi) + 4*f(xi+0.5) + f(xi+1)) * (xi+1 - xi)
     i
```

![image](https://user-images.githubusercontent.com/25401699/144398601-fc3b1255-b6e8-489b-a306-db6431f15ed2.png)

### Интегрирование по монтекарло

Алгоритм основывается на случайных числах.
Будем рандомить точки, если точка попадает в интегрируемую область - увеличим число K. Всего точек - N.
Тогда если имеем отрезок [a, b].
И еще:
```
y0 = min(f(x))
y1 = max(f(x)).
S0 = (b - a) * (y1 - y0)
```
Тогда окончательно интеграл равен 
```
S = S0 * K / N
```

![image](https://user-images.githubusercontent.com/25401699/144396801-0e8629a3-4259-4da8-8307-e66e53b0cb1e.png)

## Одномерное уравнение мелкой воды

## Двумерное уравнение мелкой воды
