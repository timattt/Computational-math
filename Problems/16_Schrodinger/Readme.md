# Уравнение Шредингера

Решаем стационарный случай.

$$
\hat H \psi = E \psi
$$

где

$$
\hat H \psi(x) = -\frac{\hbar^2}{2m}\Delta\psi(x) + U(x)\psi(x) = ъ \Delta\psi(x) + U(x)\psi(x)
$$

Теперь сделаем апроксимацию:

$$
\hat H \psi_i = ъ\frac{1}{h^2}[ \psi_{i-1} - 2\psi_i + \psi_{i+1}] + U_i \psi_i = \psi_{i-1} \frac{ъ}{h^2} + \psi_i [U_i - 2\frac{ъ}{h^2}] + \psi_{i+1}\frac{ъ}{h^2} =
\beta \psi_{i-1} + \alpha_i \psi_i + \beta \psi_{i+1}
$$

Учтем граничные условия:

$$
\lim_{x \to -\infty} \psi(x) = \lim_{x \to +\infty} \psi(x) = 0 
$$

Но в рамках конечной сетки это означает, что

$$
\psi_{-1} = \psi_{N+1} = 0
$$

Тогда имея сетку из N узлов получим матрицу линейного оператора над вектором-сеткой:

$$
\begin{pmatrix}
\alpha_0 & \beta & 0 & 0 & 0 \\
\beta & \alpha_1 & \beta & 0 & 0 \\
0 & \beta & \alpha_2 & \beta & 0 \\
0 & 0 & \beta & \alpha_3 & \beta \\
0 & 0 & 0 & \beta & \alpha_4
\end{pmatrix}
\begin{pmatrix}
\psi_0 \\
\psi_1 \\
\psi_2 \\
\psi_3 \\
\psi_4
\end{pmatrix}=
E
\begin{pmatrix}
\psi_0 \\
\psi_1 \\
\psi_2 \\
\psi_3 \\
\psi_4
\end{pmatrix}
$$

Решая спектральную задачу для такой матрицы мы найдем связные состояния.
Единственное, что мы найдем состояния сразу и дискретного и непрерывного спектров, чтобы найти только дискретный, нужно потребовать для собственного числа:

$$
U_{\min} < E < U_{\max}
$$

## Тестирование

### Прямоугольная яма

Рассмотрим прямоугольную яму конечного размера.
Глубина 600ЭВ, ширина 1 радиус_бора

![image](https://user-images.githubusercontent.com/25401699/201887867-1a98b94f-263e-4605-9f0f-32c84f1d8e81.png)

При такой конфигурации нашлось 5 дискретных уровней энергии.

### Гармонический осциллятор

![image](https://user-images.githubusercontent.com/25401699/201888718-637dbaa7-00c0-4d25-845f-84489e1d73b3.png)

Здесь потенциал имеет вид:

$$
U(x) = -\frac{\hbar^2}{2m}\psi(x) + \frac{m\omega^2 x^2}{2}\psi(x)
$$

где

$$
\omega = 10 \frac{\hbar}{m a_{b}^2}
$$

### Оценка точности

Возьмем задачу гармонического осциллятора.
Как известно, уровни энергии задаются вот так:

$$
E_n = \hbar \omega (n + \frac{1}{2})
$$

Тогда, можем сравнить это с тем, что выдает программа.

![image](https://user-images.githubusercontent.com/25401699/201889954-014d85cd-cc18-4592-a44e-2675d3fba323.png)

Получаем второй порядок по разбиению координаты. Что логично, ибо мы апроксимировали лапласиан вторым порядком.

### Численное решение задач по квантмеху

Вот [тут](https://github.com/timattt/Project-computational-math/tree/master/Problems/16_Schrodinger/Tasks/sdacha1/Special) есть решение одной из задач из первого задания.
